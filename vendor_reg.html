{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Profile Completion</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css'>
    <link rel='stylesheet' href='https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css'>
    <link rel='stylesheet'
        href='https://cdnjs.cloudflare.com/ajax/libs/awesome-bootstrap-checkbox/0.3.7/awesome-bootstrap-checkbox.min.css'>
    <link rel="stylesheet" href="{% static 'fullstack/css/profilecss.css' %}">
</head>

<body>
    {% if email is not none %}
    <div class="container" id="Profile">
        <h2>Complete Your Profile</h2>
        <form>
            <label for="companyname">Company Name:</label>
            <input type="text" id="companyname" name="companyname" required>

            <label for="address"> Address: </label>
            <input type="text" id="address" name="address" required>


            <label for="phone">Phone</label>
            <input type="number" id="phone" name="phone" required>

            <label for="dob">Date of Birth:</label>
            <input type="date" id="dob" name="dob" required>

            <label for="gender">Gender:</label>
            <select id="gender" name="gender" required>
                <option value="male">Male</option>
                <option value="female">Female</option>
                <option value="other">Other</option>
            </select>

            <label for="Products provided">Type of Product Provided:</label>

            <input type="text" id="productprovided" name="productprovided">

            <button type="submit">Submit</button>
        </form>
    </div>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js'></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js'></script>

    <script>
        $(document).ready(function () {
            // Handle form submission
            $('form').submit(function (event) {
                event.preventDefault();
                // Create a data object with form values
                var data = {
                    companyname: $('#companyname').val(),
                    address: $('#address').val(),
                    phone: $('#phone').val(),
                    dob: $('#dob').val(),
                    gender: $('#gender').val(),
                    productprovided: $('#productprovided').val()
                };

                // Make an AJAX request to the backend
                $.ajax({
                    type: 'POST',
                    url: '/user/vendor/',
                    data: JSON.stringify(data),
                    contentType: 'application/json',
                    success: function (response) {
                        console.log(response);
                        if (response.status === "success") {
                            // Handle successful response
                            window.location.href = response.redirect_url;
                            console.log(response.status + "->" + response.message);
                        } else {
                            // Handle error response
                            alert('An error occurred: ' + response.message);
                        }
                    },
                    error: function (xhr, status, error) {
                        // Handle general AJAX errors
                        console.error(xhr, status, error);
                        alert('AJAX error occurred: ' + status + ' - ' + error);
                    }
                });
            });
        });

    </script>
    {% else %}
    <h1>Your not logged in</h1>
    {% endif %}
</body>

</html>